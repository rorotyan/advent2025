<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🎄 Advent Calendar 🎁</title>

<!-- 手書き風フォント -->
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: 'Patrick Hand', sans-serif;
  color: #fff;
  overflow-x: hidden;
  background: url('images/background-night-city.jpg') no-repeat center center fixed;
  background-size: cover;
  position: relative;
}

/* パスワード画面 */
#passwordScreen {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 100;
  color: #fff;
}
#passwordScreen input {
  font-family: 'Patrick Hand', sans-serif;
  font-size: 18px;
  padding: 10px;
  margin-top: 10px;
  border-radius: 8px;
  border: none;
  outline: none;
}
#passwordScreen button {
  margin-top: 10px;
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background:#388e3c;
  color:#fff;
  font-family: 'Patrick Hand', sans-serif;
}
#passwordScreen button:hover { background:#2e7d32; }

/* 動画画面 */
#videoScreen {
  display:none;
  position: fixed;
  inset: 0;
  background: #000;
  justify-content: center;
  align-items: center;
  z-index: 90;
}

/* オーバーレイ */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.2);
  z-index: 0;
}

/* タイトル */
.header {
  text-align: center;
  margin: 40px 0 20px 0;
  font-size: 36px;
  text-shadow: 0 0 5px #fff, 0 0 10px #ff0, 0 0 20px #f00;
  animation: glow 2s infinite alternate;
  position: relative;
  z-index: 2;
}
@keyframes glow {
  0%{ text-shadow: 0 0 5px #fff, 0 0 10px #ff0; }
  100%{ text-shadow: 0 0 10px #fff, 0 0 20px #ff0, 0 0 30px #f00; }
}

/* 雪 */
@keyframes snow { 0%{ transform: translateY(0); opacity:1;} 100%{transform:translateY(100vh);opacity:0;} }
.snowflake { position: fixed; top:-10px; color:white; opacity:0.9; font-size:22px; animation:snow linear infinite; pointer-events:none; }

/* カレンダー（7列） */
.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 5px;
  padding: 10px;
  max-width: 90vw;
  margin: 0 auto 60px auto;
  position: relative;
  z-index: 2;
  display:none; /* 最初は非表示 */
}

/* 扉ボタン */
.door {
  background:#fff;
  border-radius:8px;
  text-align:center;
  font-size:16px;
  padding:15px 0;
  box-shadow:0 3px 0 #ccc;
  cursor:pointer;
  transition: transform 0.3s, background 0.3s;
  position: relative;
}
.door:hover { transform: scale(1.05) rotateZ(-1deg); background:#f0f0f0; } /* 手書き風軽く傾く */
.locked { background:#eee; cursor:not-allowed; opacity:0.6; }

/* 日付文字色 */
.door.weekday { color: #000; }
.door.saturday { color: #1976d2; }
.door.sunday { color: #d32f2f; }

/* 扉開きアニメーション */
.door.open::after {
  content:'';
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(255,255,255,0.1);
  transform-origin:left center;
  animation:flip 0.4s forwards;
  pointer-events: none;
}
@keyframes flip { 0%{transform:rotateY(0deg);} 100%{transform:rotateY(180deg);} }

/* モーダル */
.modal {
  display:none;
  position:fixed;
  z-index:50;
  left:0;
  top:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  justify-content:center;
  align-items:center;
  flex-direction:column;
}
.modal-content {
  background: url('images/paper-bg.png') no-repeat center center/cover;
  color: #333;
  border-radius: 16px;
  padding: 30px 25px;
  text-align: left;
  width: 90%;
  max-width: 450px;
  box-shadow: 0 5px 25px rgba(0,0,0,0.4);
  overflow-y: auto;
  max-height: 80%;
  font-family: 'Patrick Hand', 'Comic Sans MS', cursive, sans-serif;
  line-height: 1.8em;
  font-size: 18px;
}
.modal-content p { margin:10px 0; }
.modal-content a { color:#c62828; text-decoration:none; }
.modal-content a:hover { text-decoration:underline; }

/* ギャラリー */
.gallery { display:flex; overflow-x:auto; gap:10px; margin-top:10px; }
.gallery img { border-radius:8px; height:120px; }

/* 閉じるボタン */
.close-btn {
  margin-top:15px;
  background:#388e3c;
  color:#fff;
  padding:10px 20px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}
.close-btn:hover { background:#2e7d32; }
</style>
</head>
<body>

<!-- パスワード画面 -->
<div id="passwordScreen">
  <h2>パスワードを入力してください</h2>
  <input type="password" id="passwordInput" placeholder="パスワード">
  <button onclick="checkPassword()">OK</button>
  <p id="passwordError" style="color:#ff6666;margin-top:10px;display:none;">パスワードが違います</p>
</div>

<!-- 動画画面 -->
<div id="videoScreen">
  <video id="introVideo" src="intro.mp4" autoplay muted playsinline></video>
</div>

<div class="overlay"></div>
<div class="header">🎄 Advent Calendar 🎁</div>

<!-- BGM -->
<audio id="bgm" loop>
  <source src="bgm.mp3" type="audio/mpeg">
</audio>

<!-- 雪 -->
<script>
for(let i=0;i<30;i++){
  let s=document.createElement('div');
  s.className='snowflake';
  s.innerHTML='❄';
  s.style.left=Math.random()*100+'vw';
  s.style.animationDuration=(5+Math.random()*5)+'s';
  s.style.fontSize=(15+Math.random()*15)+'px';
  document.body.appendChild(s);
}
</script>

<!-- カレンダー -->
<div class="calendar" id="calendar"></div>

<!-- モーダル -->
<div id="modal" class="modal">
  <div class="modal-content" id="modalContent"></div>
  <button class="close-btn" onclick="closeModal()">閉じる</button>
</div>

<script>
// メッセージ内容
const messages = {
1:{text:"びっくりした？<br>何か面白いことできないかなと思って、ちまちまこんなの用意してた。", img:["images/day1.jpg","images/day1-2.jpg"]},
2:{text:"2日目：今日もあなたが笑ってますように ☺️", img:["images/day2.jpg"]},
3:{text:"3日目：このリンクを見てね →", link:"https://example.com"},
4:{text:"4日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
5:{text:"5日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
6:{text:"6日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
7:{text:"7日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
8:{text:"8日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
9:{text:"9日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
10:{text:"10日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
11:{text:"11日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
12:{text:"12日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
13:{text:"13日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
14:{text:"14日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
15:{text:"15日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
16:{text:"16日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
17:{text:"17日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
18:{text:"18日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
19:{text:"19日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
20:{text:"20日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
21:{text:"21日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
22:{text:"22日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
23:{text:"23日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
24:{text:"24日目：クリスマスまであと少し！", img:["images/day4.jpg"]},
25:{text:"25日目:メリークリスマス。<br>プレゼントを開けてください。", link:"https://example.com"}
};

// 今日の日付
const today = new Date().getDate();
const calendar = document.getElementById('calendar');

// BGM制御
const bgm = document.getElementById('bgm');
let bgmStarted = false;

// BGMを最初のクリックで有効化（スマホ対応）
document.body.addEventListener('click', () => {
  if(!bgmStarted){
    bgm.play().catch(()=>{});
    bgmStarted = true;
  }
}, { once: true });

// 扉生成
function showCalendar(){
  for(let i=1;i<=25;i++){
    const door = document.createElement('div');
    door.className='door';
    door.textContent=i;

    let weekday = (i-1) % 7;
    if(weekday === 5) door.classList.add('sunday');
    else if(weekday === 6) door.classList.add('saturday');
    else door.classList.add('weekday');

    if(i>today){ door.classList.add('locked'); }
    else{ door.onclick=()=>openModal(i,door); }

    calendar.appendChild(door);
  }
  calendar.style.display='grid';
}

// パスワードチェック
function checkPassword(){
  const input = document.getElementById('passwordInput').value;
  if(input === "toyroom"){
    document.getElementById('passwordScreen').style.display='none';
    playVideo();
  } else{
    document.getElementById('passwordError').style.display='block';
    document.getElementById('passwordInput').value='';
  }
}

// 動画再生
function playVideo(){
  const videoScreen = document.getElementById('videoScreen');
  const video = document.getElementById('introVideo');
  videoScreen.style.display='flex';
  video.play();
  video.onended = () => {
    videoScreen.style.display='none';
    showCalendar();
  };
}

// モーダル開く
function openModal(day,door){
  if(!bgmStarted){ bgm.play().catch(()=>{}); bgmStarted=true; }
  door.classList.add('open');

  const data = messages[day];
  const modal = document.getElementById('modal');
  const content = document.getElementById('modalContent');

  if(!data){
    content.innerHTML=`<p>この日のメッセージはまだ秘密です🎄</p>`;
  }else{
    let html=`<p>${data.text}</p>`;
    if(data.img){
      html+=`<div class="gallery">`;
      data.img.forEach(src=>{ html+=`<img src="${src}">`; });
      html+=`</div>`;
    }
    if(data.link) html+=`<p><a href="${data.link}" target="_blank">🎁</a></p>`;
    content.innerHTML=html;
  }

  modal.style.display='flex';
}

// モーダル閉じる
function closeModal(){ document.getElementById('modal').style.display='none'; }
</script>
</body>
</html>
