<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🎄 Advent Calendar 🎁</title>

<!-- 手書き風フォント -->
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: 'Patrick Hand', sans-serif;
  color: #fff;
  overflow-x: hidden;
  background: url('images/background-night-city.jpg') no-repeat center center fixed;
  background-size: cover;
  position: relative;
}

/* パスワード画面 */
#passwordScreen {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 100;
  color: #fff;
}
#passwordScreen input {
  font-family: 'Patrick Hand', sans-serif;
  font-size: 18px;
  padding: 10px;
  margin-top: 10px;
  border-radius: 8px;
  border: none;
  outline: none;
}
#passwordScreen button {
  margin-top: 10px;
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background:#cbb3e6;
  color:#fff;
  font-family: 'Patrick Hand', sans-serif;
}
#passwordScreen button:hover { background:#cbb3e6; }

/* 動画画面 */
#videoScreen {
  display:none;
  position: fixed;
  inset: 0;
  background: #000;
  justify-content: center;
  align-items: center;
  z-index: 90;
}

/* オーバーレイ */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.2);
  z-index: 0;
}

/* タイトル */
.header {
  text-align: center;
  margin: 40px 0 20px 0;
  font-size: 36px;
  text-shadow: 0 0 5px #fff, 0 0 10px #ff0, 0 0 20px #f00;
  animation: glow 2s infinite alternate;
  position: relative;
  z-index: 2;
}
@keyframes glow {
  0%{ text-shadow: 0 0 5px #fff, 0 0 10px #ff0; }
  100%{ text-shadow: 0 0 10px #fff, 0 0 20px #ff0, 0 0 30px #f00; }
}

/* 雪 */
@keyframes snow { 0%{ transform: translateY(0); opacity:1;} 100%{transform:translateY(100vh);opacity:0;} }
.snowflake { position: fixed; top:-10px; color:white; opacity:0.9; font-size:22px; animation:snow linear infinite; pointer-events:none; }

/* カレンダー（7列） */
.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 5px;
  padding: 10px;
  max-width: 90vw;
  margin: 0 auto 60px auto;
  position: relative;
  z-index: 2;
  display:none; /* 最初は非表示 */
}

/* 扉ボタン */
.door {
  background:#fff;
  border-radius:8px;
  text-align:center;
  font-size:16px;
  padding:15px 0;
  box-shadow:0 3px 0 #ccc;
  cursor:pointer;
  transition: transform 0.3s, background 0.3s;
  position: relative;
}
.door:hover { transform: scale(1.05) rotateZ(-1deg); background:#f0f0f0; } /* 手書き風軽く傾く */
.locked { background:#eee; cursor:not-allowed; opacity:0.6; }

/* 日付文字色 */
.door.weekday { color: #000; }
.door.saturday { color: #1976d2; }
.door.sunday { color: #d32f2f; }

/* 扉開きアニメーション */
.door.open::after {
  content:'';
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(255,255,255,0.1);
  transform-origin:left center;
  animation:flip 0.4s forwards;
  pointer-events: none;
}
@keyframes flip { 0%{transform:rotateY(0deg);} 100%{transform:rotateY(180deg);} }

/* モーダル */
.modal {
  display:none;
  position:fixed;
  z-index:50;
  left:0;
  top:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  justify-content:center;
  align-items:center;
  flex-direction:column;
}
.modal-content {
  background: url('images/paper-bg.png') no-repeat center center/cover;
  color: #333;
  border-radius: 16px;
  padding: 30px 25px;
  text-align: left;
  width: 90%;
  max-width: 450px;
  box-shadow: 0 5px 25px rgba(0,0,0,0.4);
  overflow-y: auto;
  max-height: 80%;
  font-family: 'Patrick Hand', 'Comic Sans MS', cursive, sans-serif;
  line-height: 1.8em;
  font-size: 15px;
}
.modal-content p { margin:10px 0; }
.modal-content a { color:#c62828; text-decoration:none; }
.modal-content a:hover { text-decoration:underline; }

/* ギャラリー */
.gallery { display:flex; overflow-x:auto; gap:10px; margin-top:10px; }
.gallery img { border-radius:8px; height:120px; }

/* 閉じるボタン */
.close-btn {
  margin-top:15px;
  background:#cbb3e6;
  color:#fff;
  padding:10px 20px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}
.close-btn:hover { background:#cbb3e6; }
</style>
</head>
<body>

<!-- パスワード画面 -->
<div id="passwordScreen">
  <h2>パスワードを入力してください</h2>
  <input type="password" id="passwordInput" placeholder="****/**/**">
  <button onclick="checkPassword()">GO</button>
  <p id="passwordError" style="color:#ff6666;margin-top:10px;display:none;">パスワードが違いますけども。</p>
</div>

<!-- 動画画面 -->
<div id="videoScreen">
  <video id="introVideo" src="intro.mp4" autoplay muted playsinline></video>
</div>

<div class="overlay"></div>
<div class="header">🎄 Advent Calendar 🎁</div>

<!-- BGM -->
<audio id="bgm" loop>
  <source src="bgm.mp3" type="audio/mpeg">
</audio>

<!-- 雪 -->
<script>
for(let i=0;i<30;i++){
  let s=document.createElement('div');
  s.className='snowflake';
  s.innerHTML='❄';
  s.style.left=Math.random()*100+'vw';
  s.style.animationDuration=(5+Math.random()*5)+'s';
  s.style.fontSize=(15+Math.random()*15)+'px';
  document.body.appendChild(s);
}
</script>

<!-- カレンダー -->
<div class="calendar" id="calendar"></div>

<!-- モーダル -->
<div id="modal" class="modal">
  <div class="modal-content" id="modalContent"></div>
  <button class="close-btn" onclick="closeModal()">とじる</button>
</div>

<script>
// メッセージ内容
const messages = {
1:{text:"びっくりした？<br>何か面白いことできないかなと思って、ちまちまこんなの用意してた。<br>ちょっとした楽しみにでもなったら嬉しいです。<br>ということで、1日目のプレゼントはこのカレンダーです。ちょっとずるかもこれ。25日分考えるのって大変なんだ。大目に見てください。"},
2:{text:"2日目のプレゼントは、肩たたき券です。いいですか？肩たたき券です。昨日とどっちが驚いた？2日目でもうネタ切れ！？と思った？見てろよ、僕の肩たたきのテクニックを。"},
3:{text:"3日目のプレゼントは、警告です。いやあ、ありがたいよね、警告。己の身を守る為には必要なものではないでしょうか。この先25日までの期間、2日目がそうであったように色んな券がアドベントカレンダーによってプレゼントされますが、使用するか否かは君次第です。いっぱいあるからって消費しないと…！なんて思わなくていい。なんとなくふと思い出した時にちょっとしたお遊び要素や話のタネになるくらいでいいよと。そういうお話です。"},
4:{text:"4日目です。昨日の警告は憶えておりますでしょうか。今日のプレゼントはルンルン券です。なんだそれ。と思いましたか？僕も思ってるよ。早くも4日目でな。"},
5:{text:"5日目です。ここまでカレンダーと警告と摩訶不思議な券を２枚押し付けられたガクくんの気持ちを想像すると、僕は胃が痛まないでもないよ。<br>さて、そんな本日ではございますが、こちらのプレゼントボックスを開けてください。",link:"https://giftee.com/r/PgH3YngByYrJTkMDvnkZe8YuEXQhHHgN"},
6:{text:"6日目のプレゼントは、ひと口チョコです。僕が保管しているのでお申し付けください。ちなみに、いちごとキャラメルがあるよ。お好きな方を選んでください。"},
7:{text:"7日目のプレゼントは、あの日の君の罰ゲームになぞらえて。君の好きなところを3つ。<br>1つ。距離感の取り方が上手なところ。僕が安牌を選びすぎるきらいがあるから、適度に選択肢を増やしてくれるのがありがたい。僕以外にもそう思っている人は多そう。<br>2つ。甘え上手なところ。甘えられるのって嬉しいし、愛情が伝わってんだなあと思って安心するところがある。いい塩梅で甘えてくれて大変助かっています。<br>3つ。基本柔軟で人に合わせられる人ではありつつ、芯はしっかりあるところ。お互いの芯がぶつかって譲れない瞬間がちょくちょく出てきたなって、1年が近づいたあたりから感じるようになってきた。なんでも合わせてもらうとかなんでもいいよりずっといいし、その時は納得できないって顔をしてしまうかもしれないけど、君という僕にとって大切な人の価値観だからこそ僕も、納得できなくとも理解は死体と思えるから、見識の広がりを感じる。君との時間で僕自身が成長できると感じます。"},
8:{text:"8日目のプレゼントはこちらになります。本来のアドベントカレンダーってこういうものだよね。",link:"https://example.com"},
9:{text:"9日目のプレゼントは、ログです。なんの？って思うでしょ。キス部屋のログです。アドベントカレンダーに他の人間とのキス部屋のログ入れるやつ何なんだよ。だってガクくんが読んでみたいって前に言ってたんだもん。本当だぞこれは。見たくなかったら捨ておいてください。",link:"https://rorotyan.github.io/chatlog/"},
10:{text:"10日目の今日は、僕らがお付き合いして1年と5ケ月の日です。来月で1.5周年だそうで。早いねえ。<br>ということでプレゼントは、1日変身券です。<br>君が用意したものでもいいし、リクエストがあれば僕が用意しますが、好きな姿に変身します。石だろうが米粒だろうがなんだって。1日とはいうけど、君の好きなタイミングで元に戻してください。<br>丸1日石とかになるとそれは「黙れ」と同義だけどな。"},
11:{text:"11日目のプレゼントは、"},
12:{text:"12日目のプレゼントは思い出です。ガクくん憶えてるかなあこれ。", img:["images/day4.jpg"]},
13:{text:"13日目のプレゼントは、簡単デート券です。ガクくんが食べたいもの食べに行こう。コンビニでもいいし、どこかしらのチェーン店でもいい。この間のコンビニデートみたいに気楽に君と時間を共有できる券です。気づいた？僕がやりたいだけ。"},
14:{text:"14日目のプレゼントは、",link:"https://example.com"},
15:{text:"15日目のプレゼントは、"},
16:{text:"16日目のプレゼントは、"},
17:{text:"17日目のプレゼントは、"},
18:{text:"18日目のプレゼントは、こちらです。定期的にアドベントカレンダーに本来の顔を思い出させる試み。",link:"https://example.com"},
19:{text:"19日目のプレゼントは、", img:["images/day4.jpg"]},
20:{text:"20日目のプレゼントは、1日媚び貫通券です。そろそろ僕の手札が限界なことにお気づきでしょうか。きっと後で僕はこの券にしたことを後悔するよ。君の目に触れるまでこの内容が変わってないのだとしたら、僕の漢気は相当なものだ。褒められるべき。"},
21:{text:"21日目のプレゼントは、こちらになります。君がドン引かないことを切に願ってる。思いついた時点でなんか…もしかしてめっちゃ重くないか…？と思ったんだけどさあ…。思いついちゃったんだから仕方なくないか。",link:"https://example.com"},
22:{text:"22日目のプレゼントはピノです。ちなみに僕の分も買ってきてあります。引き換えられたら教えて。一緒に食べよう。", link:"https://example.com"},
23:{text:"23日目のプレゼントは、"},
24:{text:"24日目の今日は、手紙を用意してみました。はたしていつ書いた手紙だろうね。下手したら内容に齟齬が生まれてるかもしれないけど、君を思って書いたことに間違いはないでしょう。", img:["images/day4.jpg"]},
25:{text:"25個プレゼントを考えるって、よく考えたら正気の沙汰ではなかったなと我ながら思ってる。でも君が楽しめたなら、やってみてよかったなと思います。ということで、メリークリスマス。<br>プレゼントを開けてください。", link:"https://example.com"}
};

// 今日の日付
const today = new Date().getDate();
const calendar = document.getElementById('calendar');

// BGM制御
const bgm = document.getElementById('bgm');
let bgmStarted = false;

// BGMを最初のクリックで有効化（スマホ対応）
document.body.addEventListener('click', () => {
  if(!bgmStarted){
    bgm.play().catch(()=>{});
    bgmStarted = true;
  }
}, { once: true });

// 扉生成
function showCalendar(){
  for(let i=1;i<=25;i++){
    const door = document.createElement('div');
    door.className='door';
    door.textContent=i;

    let weekday = (i-1) % 7;
    if(weekday === 5) door.classList.add('sunday');
    else if(weekday === 6) door.classList.add('saturday');
    else door.classList.add('weekday');

    if(i>today){ door.classList.add('locked'); }
    else{ door.onclick=()=>openModal(i,door); }

    calendar.appendChild(door);
  }
  calendar.style.display='grid';
}

// パスワードチェック
function checkPassword(){
  const input = document.getElementById('passwordInput').value;
  if(input === "20240710"){
    document.getElementById('passwordScreen').style.display='none';
    playVideo();
  } else{
    document.getElementById('passwordError').style.display='block';
    document.getElementById('passwordInput').value='';
  }
}

// 動画再生
function playVideo(){
  const videoScreen = document.getElementById('videoScreen');
  const video = document.getElementById('introVideo');
  videoScreen.style.display='flex';
  video.play();
  video.onended = () => {
    videoScreen.style.display='none';
    showCalendar();
  };
}

// モーダル開く
function openModal(day,door){
  if(!bgmStarted){ bgm.play().catch(()=>{}); bgmStarted=true; }
  door.classList.add('open');

  const data = messages[day];
  const modal = document.getElementById('modal');
  const content = document.getElementById('modalContent');

  if(!data){
    content.innerHTML=`<p>この日のメッセージはまだ秘密です🎄</p>`;
  }else{
    let html=`<p>${data.text}</p>`;
    if(data.img){
      html+=`<div class="gallery">`;
      data.img.forEach(src=>{ html+=`<img src="${src}">`; });
      html+=`</div>`;
    }
    if (data.link)
  html += `
    <p style="text-align:center;">
      <a href="${data.link}" target="_blank">
        <img src="images/present.png" alt="プレゼント" style="width:90px; height:90px; cursor:pointer;">
      </a>
    </p>
  `;
    content.innerHTML=html;
  }

  modal.style.display='flex';
}

// モーダル閉じる
function closeModal(){ document.getElementById('modal').style.display='none'; }
</script>
</body>
</html>
